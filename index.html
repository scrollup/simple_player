<!DOCTYPE html>
<html>
<head>
    <title>Audio Playlist</title>
</head>
<body>
    <h1>Audio Playlist</h1>
    
    <audio id="audioPlayer" controls>
        Your browser does not support the audio element.
    </audio>
    
    <p>Currently Playing: <span id="currentTrack">Audio 1</span></p>
    <p>Autoplay Status: <span id="autoplayStatus">On</span></p>
    
    <ul id="playlist">
    </ul>

    <button id="toggleAutoPlay">Toggle Auto Play</button>

    <script src="id3-parser.min.js"></script>

    <script>
        const playlist = document.getElementById("playlist");
        const audioPlayer = document.getElementById("audioPlayer");
        const currentTrackElement = document.getElementById("currentTrack");
        const autoplayStatusElement = document.getElementById("autoplayStatus");
        const toggleAutoPlayButton = document.getElementById("toggleAutoPlay");

        let currentTrack = 0;
        let audioFiles = [];
        let autoPlay = true;

        // Replace this with your MP3 file paths
        const mp3Files = [
            "audio1.mp3",
            "audio2.mp3",
            "audio3.mp3"
        ];

        // Function to load and play the next track
        function playNextTrack() {
            if (currentTrack < mp3Files.length) {
                loadAndPlay(mp3Files[currentTrack]);
                currentTrack++;
            } else {
                // If the last track is reached, loop back to the first track
                currentTrack = 0;
                loadAndPlay(mp3Files[currentTrack]);
            }
        }

        // Function to load and play an MP3 file
        function loadAndPlay(mp3File) {
            fetch(mp3File)
                .then(response => response.arrayBuffer())
                .then(data => {
                    const parser = new ID3Parser(data);
                    parser.parse();
                    const title = parser.getID3v1Tag().title || "Unknown Title";
                    currentTrackElement.textContent = title;
                    audioPlayer.src = URL.createObjectURL(new Blob([data], { type: "audio/mpeg" }));
                    audioPlayer.load();
                    if (autoPlay) {
                        audioPlayer.play();
                    }
                })
                .catch(error => console.error("Error loading MP3 file", error));
        }

        // Play the first track when the page loads
        playNextTrack();

        // Event listener for when the audio track ends
        audioPlayer.addEventListener("ended", playNextTrack);

        // Event listener to toggle autoplay
        toggleAutoPlayButton.addEventListener("click", function () {
            autoPlay = !autoPlay;
            autoplayStatusElement.textContent = autoPlay ? "On" : "Off";
            if (!autoPlay) {
                audioPlayer.pause();
            }
        });
    </script>
</body>
</html>
